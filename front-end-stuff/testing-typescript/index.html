<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta name="generator" content="Hugo 0.101.0" />
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="It&rsquo;s sort of a pain # Especially when there&rsquo;s DOM stuff and ESM involved.
You would think that in 2022, it would be easy to write tests for your library that uses TS, DOM manipulation, and ESM.
Haha, no.
1. Make a new tsconfig file # Yeah, cuz es6 is not 7 years old apparently.
Something like this (in tsconfig.callitwhatyouwant.json)
{ &#34;compilerOptions&#34;: { &#34;outDir&#34;: &#34;./dist/&#34;, &#34;module&#34;: &#34;commonjs&#34;, // required for tests &#34;target&#34;: &#34;es5&#34;, &#34;strict&#34;: true, &#34;sourceMap&#34;: true, &#34;jsx&#34;: &#34;react&#34;, &#34;lib&#34;: [ &#34;es2015&#34;, &#34;es2016&#34;, &#34;es2017&#34;, &#34;dom&#34; ], }, &#34;include&#34;: [&#34;src/**/*.">
<meta name="theme-color" content="#FFFFFF"><meta property="og:title" content="Testing Typescript" />
<meta property="og:description" content="It&rsquo;s sort of a pain # Especially when there&rsquo;s DOM stuff and ESM involved.
You would think that in 2022, it would be easy to write tests for your library that uses TS, DOM manipulation, and ESM.
Haha, no.
1. Make a new tsconfig file # Yeah, cuz es6 is not 7 years old apparently.
Something like this (in tsconfig.callitwhatyouwant.json)
{ &#34;compilerOptions&#34;: { &#34;outDir&#34;: &#34;./dist/&#34;, &#34;module&#34;: &#34;commonjs&#34;, // required for tests &#34;target&#34;: &#34;es5&#34;, &#34;strict&#34;: true, &#34;sourceMap&#34;: true, &#34;jsx&#34;: &#34;react&#34;, &#34;lib&#34;: [ &#34;es2015&#34;, &#34;es2016&#34;, &#34;es2017&#34;, &#34;dom&#34; ], }, &#34;include&#34;: [&#34;src/**/*." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://work.rehanvipin.me/front-end-stuff/testing-typescript/" /><meta property="article:section" content="front-end-stuff" />



<title>Testing Typescript | Field Manual</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.ece3f56fc3f716f87ccd4e6f3ea44ba1fa6757114261dadfbf861fde7d4e6203.css" integrity="sha256-7OP1b8P3Fvh8zU5vPqRLofpnVxFCYdrfv4Yf3n1OYgM=">
<script defer src="/en.search.min.4ae859ffcc42435f7ea42b9098da524b8a8b6a73dc43bc84dda6bb25f8414e23.js" integrity="sha256-SuhZ/8xCQ19&#43;pCuQmNpSS4qLanPcQ7yE3aa7JfhBTiM="></script>

<script defer src="/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js" integrity="sha256-b2&#43;Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC&#43;NdcPIvZhzk="></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a href="/"><img src="/favicon.png" alt="Logo" /><span>Field Manual</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>











  



  
  <ul>
    
      
        <li class="book-section-flat" >
          
  
  

  
    <input type="checkbox" id="section-c029195c85e40978d9a8f4514856eec8" class="toggle"  />
    <label for="section-c029195c85e40978d9a8f4514856eec8" class="flex justify-between">
      <a href="https://work.rehanvipin.me/angular/" class="">Angular</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://work.rehanvipin.me/angular/overview/" class="">Overview</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://work.rehanvipin.me/angular/components/" class="">Components</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://work.rehanvipin.me/angular/template/" class="">Template Syntax</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://work.rehanvipin.me/angular/services/" class="">Services</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://work.rehanvipin.me/angular/directives/" class="">Directives</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://work.rehanvipin.me/angular/routing/" class="">Routing</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://work.rehanvipin.me/angular/forms/" class="">Forms</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://work.rehanvipin.me/angular/pipes/" class="">Pipes</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://work.rehanvipin.me/angular/di/" class="">Dependency Injection</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://work.rehanvipin.me/angular/rxjs/" class="">RxJS</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://work.rehanvipin.me/angular/test/" class="">Testing</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://work.rehanvipin.me/angular/libraries/" class="">Libraries</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <a href="https://work.rehanvipin.me/front-end-stuff/" class="">Front-End</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://work.rehanvipin.me/front-end-stuff/d3/" class="">D3</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://work.rehanvipin.me/front-end-stuff/svg/" class="">SVG</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://work.rehanvipin.me/front-end-stuff/testing-typescript/" class=" active">Testing Typescript</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://work.rehanvipin.me/stolenstuff/" class="">/tmp</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://work.rehanvipin.me/whatnext/" class="">/next</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://work.rehanvipin.me/credits/" class="">/credits</a>
  

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var e=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Testing Typescript</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#its-sort-of-a-pain">It&rsquo;s sort of a pain</a>
      <ul>
        <li><a href="#1-make-a-new-tsconfig-file">1. Make a new tsconfig file</a></li>
        <li><a href="#2-install-stuff">2. Install stuff</a></li>
        <li><a href="#3-setup-the-karma-config-file">3. Setup the karma config file</a></li>
        <li><a href="#4-setup-the-package-json">4. Setup the package json</a></li>
        <li><a href="#5-write-code--tests">5. Write code &amp; tests</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="its-sort-of-a-pain">
  It&rsquo;s sort of a pain
  <a class="anchor" href="#its-sort-of-a-pain">#</a>
</h1>
<p>Especially when there&rsquo;s DOM stuff and ESM involved.</p>
<p>You would think that in 2022, it would be easy to write tests for your
library that uses TS, DOM manipulation, and ESM.</p>
<p>Haha, no.</p>
<h2 id="1-make-a-new-tsconfig-file">
  1. Make a new tsconfig file
  <a class="anchor" href="#1-make-a-new-tsconfig-file">#</a>
</h2>
<p>Yeah, cuz es6 is not 7 years old apparently.<br>
Something like this (in <code>tsconfig.callitwhatyouwant.json</code>)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;compilerOptions&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;outDir&#34;</span>: <span style="color:#e6db74">&#34;./dist/&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;module&#34;</span>: <span style="color:#e6db74">&#34;commonjs&#34;</span>, <span style="color:#75715e">// required for tests
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#f92672">&#34;target&#34;</span>: <span style="color:#e6db74">&#34;es5&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;strict&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;sourceMap&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;jsx&#34;</span>: <span style="color:#e6db74">&#34;react&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;lib&#34;</span>: [
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;es2015&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;es2016&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;es2017&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;dom&#34;</span>
</span></span><span style="display:flex;"><span>        ],
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;include&#34;</span>: [<span style="color:#e6db74">&#34;src/**/*.ts&#34;</span>, <span style="color:#e6db74">&#34;./test/**/*.ts&#34;</span>]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>remove stuff at your own risk. (But do try, this is somewhat of a mess)</p>
<h2 id="2-install-stuff">
  2. Install stuff
  <a class="anchor" href="#2-install-stuff">#</a>
</h2>
<p>I&rsquo;m using Karma and Jasmine cuz they&rsquo;re nice.</p>
<pre tabindex="0"><code>npm i -D karma karma-chrome-launcher karma-spec-reporter
npm i -D typescript karma-typescipt karma-typescript-es6-transform
npm i -D jasmine-core @types/jasmine karma-jasmine
</code></pre><h2 id="3-setup-the-karma-config-file">
  3. Setup the karma config file
  <a class="anchor" href="#3-setup-the-karma-config-file">#</a>
</h2>
<p>this should do</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#75715e">// karma.conf.js
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">module</span>.<span style="color:#a6e22e">exports</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">config</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">set</span>({
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">frameworks</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;jasmine&#34;</span>, <span style="color:#e6db74">&#34;karma-typescript&#34;</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">files</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;src/**/*.ts&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;test/**/*.ts&#34;</span>
</span></span><span style="display:flex;"><span>        ],
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">preprocessors</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;**/*.ts&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;karma-typescript&#34;</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">reporters</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;progress&#34;</span>, <span style="color:#e6db74">&#34;karma-typescript&#34;</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">browsers</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;Chrome&#34;</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">karmaTypescriptConfig</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">tsconfig</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;tsconfig.callitwhatyouwant.json&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">bundlerOptions</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">transforms</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;karma-typescript-es6-transform&#34;</span>)()
</span></span><span style="display:flex;"><span>                ]
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">singleRun</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h2 id="4-setup-the-package-json">
  4. Setup the package json
  <a class="anchor" href="#4-setup-the-package-json">#</a>
</h2>
<p>Nothing really.</p>
<pre tabindex="0"><code>&#34;scripts&#34;: {
    &#34;test&#34;: &#34;karma start&#34;,
}
</code></pre><p>That&rsquo;s it. Nothing else is required in that file.</p>
<h2 id="5-write-code--tests">
  5. Write code &amp; tests
  <a class="anchor" href="#5-write-code--tests">#</a>
</h2>
<p>Write them under <code>src/</code> and <code>test/</code> respectively.</p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>

 
        
      </footer>

      
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#its-sort-of-a-pain">It&rsquo;s sort of a pain</a>
      <ul>
        <li><a href="#1-make-a-new-tsconfig-file">1. Make a new tsconfig file</a></li>
        <li><a href="#2-install-stuff">2. Install stuff</a></li>
        <li><a href="#3-setup-the-karma-config-file">3. Setup the karma config file</a></li>
        <li><a href="#4-setup-the-package-json">4. Setup the package json</a></li>
        <li><a href="#5-write-code--tests">5. Write code &amp; tests</a></li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>

</html>












